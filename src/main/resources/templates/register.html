<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/userfragment :: common_head('Register')}"></head>

<body class="bg-light">

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5">
            <div class="card shadow-sm">
                <div class="card-body p-4">
                    <h2 class="mb-4 text-center">Create Account</h2>

                    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
                    <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>

                    <!-- user object + nested address -->
                 <!--   image ka bhi yaha hai  -->
                    <form th:action="@{/register}" th:object="${user}"  method="post" enctype="multipart/form-data">


						 <!-- GLOBAL ERRORS (Object level errors) -->
	<!--  			<div th:if="${#fields.hasGlobalErrors()}" class="alert alert-danger">
					    <ul>
					        <li th:each="err : ${#fields.globalErrors()}" th:text="${err}"></li>
					    </ul>
					</div>
					
	-->	
					
					
                        <!-- Name, Email, Password -->
                        <div class="mb-3">
                            <label class="form-label">Name</label>
                            <input type="text" th:field="*{name}" class="form-control" />
                            <div th:if="${#fields.hasErrors('name')}" class="text-danger" th:errors="*{name}"></div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Email</label>
                            <input type="email" th:field="*{email}" class="form-control"  />
                            <div th:if="${#fields.hasErrors('email')}" class="text-danger" th:errors="*{email}"></div>
                        </div>
                        
                        
                         <div class="mb-3">
                            <label class="form-label">Mobile</label>
                            <input type="text" th:field="*{mobile}" class="form-control"  />
                            <div th:if="${#fields.hasErrors('mobile')}" class="text-danger" th:errors="*{mobile}"></div>
                        </div>
 
                       	 	 
                        <div class="mb-3">
                            <label class="form-label">Password</label>
                            <input type="password" th:field="*{password}" class="form-control"  />
                            <div th:if="${#fields.hasErrors('password')}" class="text-danger" th:errors="*{password}"></div>
                        </div>

                       <div class="mb-3">
						    <label class="form-label">Confirm Password</label>
						    <input type="password" name="confirmPassword" class="form-control"/>
						    <span class="text-danger"
						          th:text="${confirmPasswordError}">
						    </span>
						</div>


                        <hr />

                        <h5 class="mb-3">Address</h5>

                        <div class="mb-3">
                            <label class="form-label">Address Line 1</label>
                            <!-- Nested object: user.address.line1 -->
                            <input type="text" th:field="*{address.line1}" class="form-control"  />
                            <div th:if="${#fields.hasErrors('address.line1')}" class="text-danger" th:errors="*{address.line1}"></div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Address Line 2</label>
                            <input type="text" th:field="*{address.line2}" class="form-control" />
                            <div th:if="${#fields.hasErrors('address.line2')}" class="text-danger" th:errors="*{address.line2}"></div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">City</label>
                            <input type="text" th:field="*{address.city}" class="form-control"  />
                            <div th:if="${#fields.hasErrors('address.city')}"
						         class="text-danger"
						         th:errors="*{address.city}">
						    </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">State</label>
                            <input type="text" th:field="*{address.state}" class="form-control"  />
						     <div th:if="${#fields.hasErrors('address.state')}"
						         class="text-danger"
						         th:errors="*{address.state}">
						    </div>
						                            
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Postal Code</label>
                            <input type="text" th:field="*{address.postalCode}" class="form-control"  />
                             <div th:if="${#fields.hasErrors('address.postalCode')}"
							         class="text-danger"
							         th:errors="*{address.postalCode}">
							    </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Country</label>
                            <input type="text" th:field="*{address.country}" class="form-control"  />
                            <div th:if="${#fields.hasErrors('address.country')}"
						         class="text-danger"
						         th:errors="*{address.country}">
						    </div>
                        </div>
                        
                        
                        <div class="mb-3">
                            <label class="form-label">image </label>
                            <input type="file" name="imagelocalupload"  class="form-control"  />
                             <!-- YE LINE IMAGE REALTED ERROR KE LIYE HAI  -->
   							 <p th:if="${imageError}" th:text="${imageError}" class="text-danger small mt-1">
                        </div>
                    

                        <button type="submit" class="btn btn-primary w-100">
                            Register
                        </button>
                    </form>

                    <p class="mt-3 text-center">
                        Already have an account?
                        <a th:href="@{/login}">Login here</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<th:block th:replace="~{fragments/userfragment :: common_scripts}"></th:block>
</body>
</html>
